{"timestamp":"2025-08-21T07:55:10.034908","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-08-21T07:55:10.035584","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/fetchin_cleaning.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-08-21T07:55:10.095800Z","level":"info","event":"Task instance is in running state","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-21T07:55:10.096367Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-21T07:55:10.096929Z","level":"info","event":"Current task name:clean_data","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-21T07:55:10.097199Z","level":"info","event":"Dag name:weather_to_snowflake_pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.196589Z","level":"error","event":"Traceback (most recent call last):","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.197055Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py\", line 3791, in get_loc","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.197433Z","level":"error","event":"    return self._engine.get_loc(casted_key)","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.197725Z","level":"error","event":"           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.197984Z","level":"error","event":"  File \"index.pyx\", line 152, in pandas._libs.index.IndexEngine.get_loc","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.198333Z","level":"error","event":"  File \"index.pyx\", line 158, in pandas._libs.index.IndexEngine.get_loc","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.198572Z","level":"error","event":"TypeError: '(['pollution_co', 'pollution_no', 'pollution_no2', 'pollution_o3', 'pollution_so2', 'pollution_pm2_5', 'pollution_pm10', 'pollution_nh3', 'pollution_dt'],     weather_id     city","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.198877Z","level":"error","event":"0          803    cairo","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.199163Z","level":"error","event":"1          803    cairo","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.199455Z","level":"error","event":"2          803    cairo","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.199752Z","level":"error","event":"3          803    cairo","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.200022Z","level":"error","event":"4          801   warsaw","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.200319Z","level":"error","event":"5          801   warsaw","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.200638Z","level":"error","event":"6          801   warsaw","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.200920Z","level":"error","event":"7          801   warsaw","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.201211Z","level":"error","event":"8          804  beijing","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.201500Z","level":"error","event":"9          804  beijing","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.201848Z","level":"error","event":"10         804  beijing","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.202141Z","level":"error","event":"11         804  beijing)' is an invalid key","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.202420Z","level":"error","event":"","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.202700Z","level":"error","event":"During handling of the above exception, another exception occurred:","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.202965Z","level":"error","event":"","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.203255Z","level":"error","event":"Traceback (most recent call last):","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.203497Z","level":"error","event":"  File \"/opt/airflow/dags/cleaning_data.py\", line 164, in <module>","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.203820Z","level":"error","event":"    data_cleaning()","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.204068Z","level":"error","event":"  File \"/opt/airflow/dags/cleaning_data.py\", line 126, in data_cleaning","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.204317Z","level":"error","event":"    pollutants_fact_new = df_merged[pollution_cols, df_merged[['weather_id','city']]].drop_duplicates().reset_index(drop=True)","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.204564Z","level":"error","event":"                          ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.204807Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/pandas/core/frame.py\", line 3893, in __getitem__","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.205050Z","level":"error","event":"    indexer = self.columns.get_loc(key)","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.205306Z","level":"error","event":"              ^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.205566Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py\", line 3803, in get_loc","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.205961Z","level":"error","event":"    self._check_indexing_error(key)","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.206259Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py\", line 5975, in _check_indexing_error","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.206522Z","level":"error","event":"    raise InvalidIndexError(key)","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.208030Z","level":"error","event":"pandas.errors.InvalidIndexError: (['pollution_co', 'pollution_no', 'pollution_no2', 'pollution_o3', 'pollution_so2', 'pollution_pm2_5', 'pollution_pm10', 'pollution_nh3', 'pollution_dt'],     weather_id     city","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.208377Z","level":"error","event":"0          803    cairo","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.208735Z","level":"error","event":"1          803    cairo","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.209065Z","level":"error","event":"2          803    cairo","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.209353Z","level":"error","event":"3          803    cairo","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.209642Z","level":"error","event":"4          801   warsaw","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.209920Z","level":"error","event":"5          801   warsaw","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.210257Z","level":"error","event":"6          801   warsaw","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.210559Z","level":"error","event":"7          801   warsaw","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.210834Z","level":"error","event":"8          804  beijing","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.211102Z","level":"error","event":"9          804  beijing","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.211401Z","level":"error","event":"10         804  beijing","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.211684Z","level":"error","event":"11         804  beijing)","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.307610","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"CalledProcessError","exc_value":"Command '['python', 'dags/cleaning_data.py']' returned non-zero exit status 1.","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":890,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1177,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":217,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":240,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/fetchin_cleaning.py","lineno":16,"name":"clean_data"},{"filename":"/usr/local/lib/python3.12/subprocess.py","lineno":571,"name":"run"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-08-21T07:55:11.309120Z","level":"info","event":"Task instance in failure state","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.309486Z","level":"info","event":"Task start","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.309842Z","level":"info","event":"Task:<Task(PythonOperator): clean_data>","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-21T07:55:11.310165Z","level":"info","event":"Failure caused by Command '['python', 'dags/cleaning_data.py']' returned non-zero exit status 1.","chan":"stdout","logger":"task"}
