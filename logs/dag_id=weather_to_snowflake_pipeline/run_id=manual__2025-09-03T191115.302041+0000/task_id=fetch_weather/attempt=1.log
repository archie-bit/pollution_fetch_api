{"timestamp":"2025-09-03T19:11:19.656901","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-09-03T19:11:19.658021","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/fetchin_cleaning.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-09-03T19:11:20.082082Z","level":"info","event":"Task instance is in running state","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-03T19:11:20.082623Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-03T19:11:20.084891Z","level":"info","event":"Current task name:fetch_weather","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-03T19:11:20.090988Z","level":"info","event":"Dag name:weather_to_snowflake_pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.879276Z","level":"error","event":"Traceback (most recent call last):","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.879840Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py\", line 198, in _new_conn","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.894389Z","level":"error","event":"    sock = connection.create_connection(","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.894840Z","level":"error","event":"           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.895209Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/urllib3/util/connection.py\", line 60, in create_connection","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.895517Z","level":"error","event":"    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.895750Z","level":"error","event":"               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.896019Z","level":"error","event":"  File \"/usr/local/lib/python3.12/socket.py\", line 978, in getaddrinfo","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.896313Z","level":"error","event":"    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.896602Z","level":"error","event":"               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.896865Z","level":"error","event":"socket.gaierror: [Errno -5] No address associated with hostname","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.897107Z","level":"error","event":"","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.897361Z","level":"error","event":"The above exception was the direct cause of the following exception:","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.897799Z","level":"error","event":"","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.898046Z","level":"error","event":"Traceback (most recent call last):","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.898313Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py\", line 787, in urlopen","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.898577Z","level":"error","event":"    response = self._make_request(","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.898831Z","level":"error","event":"               ^^^^^^^^^^^^^^^^^^^","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.899122Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py\", line 493, in _make_request","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.899409Z","level":"error","event":"    conn.request(","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.899735Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py\", line 494, in request","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.900002Z","level":"error","event":"    self.endheaders()","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.900233Z","level":"error","event":"  File \"/usr/local/lib/python3.12/http/client.py\", line 1333, in endheaders","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.900465Z","level":"error","event":"    self._send_output(message_body, encode_chunked=encode_chunked)","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.900698Z","level":"error","event":"  File \"/usr/local/lib/python3.12/http/client.py\", line 1093, in _send_output","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.900911Z","level":"error","event":"    self.send(msg)","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.901113Z","level":"error","event":"  File \"/usr/local/lib/python3.12/http/client.py\", line 1037, in send","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.901308Z","level":"error","event":"    self.connect()","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.901508Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py\", line 325, in connect","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.901767Z","level":"error","event":"    self.sock = self._new_conn()","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.901983Z","level":"error","event":"                ^^^^^^^^^^^^^^^^","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.902203Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py\", line 205, in _new_conn","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.902418Z","level":"error","event":"    raise NameResolutionError(self.host, self, e) from e","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.902635Z","level":"error","event":"urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPConnection object at 0x7c3bdafc2780>: Failed to resolve 'api.openweathermap.org' ([Errno -5] No address associated with hostname)","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.902883Z","level":"error","event":"","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.903095Z","level":"error","event":"The above exception was the direct cause of the following exception:","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.903336Z","level":"error","event":"","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.903605Z","level":"error","event":"Traceback (most recent call last):","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.903841Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/requests/adapters.py\", line 667, in send","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.904080Z","level":"error","event":"    resp = conn.urlopen(","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.904333Z","level":"error","event":"           ^^^^^^^^^^^^^","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.904612Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py\", line 841, in urlopen","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.904853Z","level":"error","event":"    retries = retries.increment(","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.905103Z","level":"error","event":"              ^^^^^^^^^^^^^^^^^^","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.905363Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/urllib3/util/retry.py\", line 519, in increment","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.905651Z","level":"error","event":"    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.906007Z","level":"error","event":"    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.906252Z","level":"error","event":"urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='api.openweathermap.org', port=80): Max retries exceeded with url: /geo/1.0/direct?q=cairo&appid=b0cd269e1d75cd93a3a76e2222f451c8 (Caused by NameResolutionError(\"<urllib3.connection.HTTPConnection object at 0x7c3bdafc2780>: Failed to resolve 'api.openweathermap.org' ([Errno -5] No address associated with hostname)\"))","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.906477Z","level":"error","event":"","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.906731Z","level":"error","event":"During handling of the above exception, another exception occurred:","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.907090Z","level":"error","event":"","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.907312Z","level":"error","event":"Traceback (most recent call last):","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.907524Z","level":"error","event":"  File \"/opt/airflow/dags/fetch_weather.py\", line 118, in <module>","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.907730Z","level":"error","event":"    get_pollution(city_dict)","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.907964Z","level":"error","event":"  File \"/opt/airflow/dags/fetch_weather.py\", line 36, in get_pollution","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.908233Z","level":"error","event":"    cities = get_geo(city_dict)","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.908479Z","level":"error","event":"             ^^^^^^^^^^^^^^^^^^","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.908701Z","level":"error","event":"  File \"/opt/airflow/dags/fetch_weather.py\", line 22, in get_geo","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.908914Z","level":"error","event":"    city_r = requests.get(f\"http://api.openweathermap.org/geo/1.0/direct?q={city['name']}&appid={apiKey}\")","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.909190Z","level":"error","event":"             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.909468Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/requests/api.py\", line 73, in get","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.909703Z","level":"error","event":"    return request(\"get\", url, params=params, **kwargs)","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.909920Z","level":"error","event":"           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.910141Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/requests/api.py\", line 59, in request","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.910361Z","level":"error","event":"    return session.request(method=method, url=url, **kwargs)","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.910734Z","level":"error","event":"           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.911042Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/requests/sessions.py\", line 589, in request","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.911308Z","level":"error","event":"    resp = self.send(prep, **send_kwargs)","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.911901Z","level":"error","event":"           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.912177Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/requests/sessions.py\", line 703, in send","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.912414Z","level":"error","event":"    r = adapter.send(request, **kwargs)","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.912650Z","level":"error","event":"        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.912872Z","level":"error","event":"  File \"/home/airflow/.local/lib/python3.12/site-packages/requests/adapters.py\", line 700, in send","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.913111Z","level":"error","event":"    raise ConnectionError(e, request=request)","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.913385Z","level":"error","event":"requests.exceptions.ConnectionError: HTTPConnectionPool(host='api.openweathermap.org', port=80): Max retries exceeded with url: /geo/1.0/direct?q=cairo&appid=b0cd269e1d75cd93a3a76e2222f451c8 (Caused by NameResolutionError(\"<urllib3.connection.HTTPConnection object at 0x7c3bdafc2780>: Failed to resolve 'api.openweathermap.org' ([Errno -5] No address associated with hostname)\"))","chan":"stderr","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.924945","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"CalledProcessError","exc_value":"Command '['python', 'dags/fetch_weather.py']' returned non-zero exit status 1.","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":890,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1177,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":217,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":240,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/fetchin_cleaning.py","lineno":13,"name":"fetch_weather"},{"filename":"/usr/local/lib/python3.12/subprocess.py","lineno":571,"name":"run"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-09-03T19:11:24.926346Z","level":"info","event":"Task instance in failure state","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.926746Z","level":"info","event":"Task start","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.927055Z","level":"info","event":"Task:<Task(PythonOperator): fetch_weather>","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-03T19:11:24.927323Z","level":"info","event":"Failure caused by Command '['python', 'dags/fetch_weather.py']' returned non-zero exit status 1.","chan":"stdout","logger":"task"}
